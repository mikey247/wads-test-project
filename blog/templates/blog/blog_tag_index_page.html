{% extends "base.html" %}
{% load wagtailcore_tags %}

{% block content %}

    {% if request.GET.tag|length %}
        <h4>Showing pages tagged "{{ request.GET.tag|upper }}"</h4>
    {% endif %}

    {% for blogpage in blogpages %}
	  <h4>Matching blog posts</h4>
          <p>
              <strong><a href="{% pageurl blogpage %}">{{ blogpage.title }}</a></strong><br />
              <small>Revised: {{ blogpage.latest_revision_created_at }}</small><br />
              {% if blogpage.author %}
                <p>By {{ blogpage.author.profile }}</p>
		{% if blogpage.tags.all.count %}
		  <div class="tags" style="clear: both;">
		    <h3>Tags</h3>
		    {% for tag in blogpage.tags.all %}
		      {% if tag|stringformat:"s" == request.GET.tag|stringformat:"s" %}
	                <a href="{% slugurl 'tags' %}?tag={{ tag }}"><button class="btn btn-default btn-round btn-sm">{{ tag }}</button></a>
		      {% else %}
	                <a href="{% slugurl 'tags' %}?tag={{ tag }}"><button class="btn btn-primary btn-round btn-sm">{{ tag }}</button></a>
		      {% endif %}
  	            {% endfor %}
		  </div>
		{% endif %}
              {% endif %}
          </p>

    {% empty %}
        No blog posts found with that tag.
    {% endfor %}

    {% for article in articles %}
	  <h4>Matching articles ({{articles|length}} found)</h4>
          <p>
              <h4><a href="{% pageurl article %}">{{ article.title }}</a></h4>
              <small>Revised: {{ article.latest_revision_created_at }}</small><br />
              {% if article.author %}
                <p>By {{ article.author.profile }}</p>
		{% if article.tags.all.count %}
		  <div class="tags" style="clear: both;">
		    <small>Tags</small>
		    {% for tag in article.tags.all %}
		      {% if tag|stringformat:"s" == request.GET.tag|stringformat:"s" %}
	                <a href="{% slugurl 'tags' %}?tag={{ tag }}"><button class="btn btn-default btn-round btn-sm">{{ tag }}</button></a>
		      {% else %}
	                <a href="{% slugurl 'tags' %}?tag={{ tag }}"><button class="btn btn-primary btn-round btn-sm">{{ tag }}</button></a>
		      {% endif %}
		    {% endfor %}
		  </div>
		{% endif %}
              {% endif %}
          </p>

    {% empty %}
        No articles found with that tag.
    {% endfor %}

{% endblock %}
