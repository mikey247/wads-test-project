{% extends "sitecore/base/default.html" %}
{% load shortcodes site_tags wagtailcore_tags %}

{% block head-title %}
  <title>{{ self.title }}</title>
{% endblock %}

{% block page-content-banner %}{% endblock %}

{% block page-content-aside-slot-1 %}
  <section>
    {% if slug %}
      {% if pages.specific|length %}
	<ul class="list-group">
	  <li class="list-group-item list-group-item-primary d-flex justify-content-between align-items-center">
	    <strong>Showing articles tagged:</strong>
	  </li>
	  <li class="list-group-item d-flex justify-content-between align-items-center">
	    <span class="btn btn-sm my-1 btn-outline-primary"><i class="fa fa-tag"></i> {{ name }}</span>
	  </li>
	  <li class="list-group-item list-group-item-primary d-flex justify-content-between align-items-center">
	    <strong>Found:</strong>
	  </li>
	  <li class="list-group-item d-flex justify-content-between align-items-center">
	    <h3><span class="badge badge-success">{{pages|length}}</span></h3>
	  </li>
	</ul>
      {% else %}
	<ul class="list-group">
	  <li class="list-group-item list-group-item-danger d-flex justify-content-between align-items-center">
	    <strong>No articles tagged</strong>
	  </li>
	  <li class="list-group-item d-flex justify-content-between align-items-center">
	    <span class="btn btn-sm my-1 btn-outline-danger text-lowercase"><i class="fa fa-tag"></i> {{ name }}</span>
	  </li>
	</ul>
      {% endif %}
    {% else %}
      <ul class="list-group">
	<li class="list-group-item list-group-item-info d-flex justify-content-between align-items-center">
	  <strong>Total number of tags:</strong>
	</li>
	<li class="list-group-item d-flex justify-content-between align-items-center">
	  <span class="btn btn-sm my-1 btn-info text-lowercase">{{ tags.all.count }}</span>
	</li>
      </ul>
    {% endif %}
  </section>
{% endblock page-content-aside-slot-1 %}

{% block page-content-main-header %}
  <header class="container mb-4 p-0">
    {% if slug %}
      <h1 class="mb-2"><i class="fas fa-search"></i> Tag Search Results - <i class="fas fa-tag"></i> {{ name }}</h1>
    {% else %}
      <h1 class="mb-2"><i class="fas fa-tags"></i> Tag Cloud</h1>
    {% endif %}
  </header>
{% endblock %}

{% block page-content-main-article %}
  {% if slug %}
    <article class="container m-0 p-0">
      {% for page in pages.specific %}
	<div class="bg-light p-2 mb-4 {% if not forloop.last %}border-bottom border-primary{% endif %}">
	  <h2><a href="{% pageurl page %}"><span class="badge badge-primary">{{ forloop.counter }}</span> {{ page.title }}</a></h2>
	  {% if page.content_type|stringformat:'s' == "article | article page" %}
	    <span class="badge badge-info"><i class="fas fa-scroll"></i> Article</span>
	  {% elif page.content_type|stringformat:'s' == 'event | event page' %}
	    <span class="badge badge-info"><i class="fas fa-calendar"></i> Event</span>
	  {% endif %}
	  {% if page.content_type|stringformat:'s' == 'event | event page' %}
	    <small><span class="text-dark"><i class="fas fa-calendar"></i> {{ page.start_date }}
	      {% if page.duration > 1 %}&mdash; {{ page.end_date }}{% endif %}</span></small>
	  {% else %}
	      <small><strong><i class="fas fa-calendar"></i> Published:</strong> {{ page.first_published_at }}</small>
	      {% if page.latest_revision_created_at %}
		<small><strong><i class="fas fa-calendar-alt"></i> Revised:</strong> {{ page.latest_revision_created_at }}</small>
	      {% endif %}
	  {% endif %}
	  {% include_block page.event_type with view="summary" %}
	  <hr>
	  {% if page.search_description %}
	    <div class="lead">{{ page.search_description }}</div>
	  {% elif page.intro != "<p></p>" %}
	    <div class="lead">{% include_block page.intro %}</div>
	  {% else %}
	    <p class="text-warning">Page has no introductory text or search description.</p>
	  {% endif %}
	  
	  {% if page.tags.all.count %}
	    {% taggit_list page.tags.all slug %}
	  {% endif %}
	</div>
      {% empty %}
	<span class="text-info">No pages found with that tag.</span>
      {% endfor %}
      <hr>
    </article>
  {% endif %}
{% endblock %}

{% block page-content-main-footer %}
  <footer class="my-4" role="tag cloud">
    {% if slug %}
      <h4>Tag Cloud</h4>
    {% endif %}
    {% taggit_list tags show_count=True %}
  </footer>
{% endblock %}
